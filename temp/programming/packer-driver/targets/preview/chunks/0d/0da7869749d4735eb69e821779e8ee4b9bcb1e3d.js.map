{"version":3,"sources":["file:///D:/dev/%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9/NewProject/assets/Script/View/EffectLayer.ts"],"names":["_decorator","Component","Prefab","AudioUtils","ccclass","property","EffectLayer","onLoad","playEffects","effectQueue"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,M,OAAAA,M;;AAIzBC,MAAAA,U;;;;;;;;;OAHD;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBL,U;;6BAKjBM,W,WADZF,OAAO,CAAC,aAAD,C,UAEHC,QAAQ,CAACH,MAAD,C,UAERG,QAAQ,CAACH,MAAD,C,UAERG,QAAQ;AAAA;AAAA,mC,2BANb,MACaC,WADb,SACiCL,SADjC,CAC2C;AAAA;AAAA;;AAAA;;AAAA;;AAAA;AAAA;;AAQvCM,QAAAA,MAAM,GAAI,CACT;;AAEDC,QAAAA,WAAW,CAAEC,WAAF,EAAoB,CAC3B;AACI;AACJ;AACA;AACA;AACI;AACA;AACI;AACA;AACA;AACI;AACA;AACA;AACA;AACA;AACJ;AACA;AACI;AACA;AACA;AACJ;AACA;AACI;AACA;AACA;AACJ;AACA;AACA;AACA;AACA;AACI;AACJ;AACJ;AACA;AACJ;AACH;;AA/CsC,O;;;;;iBAEpB,I;;;;;;;iBAEE,I;;;;;;;iBAED,I;;;AA8CxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourcesContent":["import { _decorator, Component, Prefab } from 'cc';\nconst { ccclass, property } = _decorator;\n\nimport {CELL_WIDTH} from '../Model/ConstValue';\nimport AudioUtils from \"../Utils/AudioUtils\";\n@ccclass('EffectLayer')\nexport class EffectLayer extends Component {\n    @property(Prefab)\n    public bombWhite = null;\n    @property(Prefab)\n    public crushEffect = null;\n    @property(AudioUtils)\n    public audioUtils = null;\n\n    onLoad () {\n    }\n\n    playEffects (effectQueue: any) {\n        // if(!effectQueue || effectQueue.length <= 0){ \n            // return ; \n        // } \n        // let soundMap = {}; //某一时刻，某一种声音是否播放过的标记，防止重复播放 \n        // effectQueue.forEach(function(cmd){ \n            // let delayTime = cc.delayTime(cmd.playTime); \n            // let callFunc = cc.callFunc(function(){ \n                // let instantEffect = null; \n                // let animation = null; \n                // if(cmd.action == \"crush\"){ \n                    // instantEffect = cc.instantiate(this.crushEffect); \n                    // animation  = instantEffect.getComponent(cc.Animation); \n                    // animation.play(\"effect\"); \n                    // !soundMap[\"crush\" + cmd.playTime] && this.audioUtils.playEliminate(cmd.step); \n                    // soundMap[\"crush\" + cmd.playTime] = true; \n                // } \n                // else if(cmd.action == \"rowBomb\"){ \n                    // instantEffect = cc.instantiate(this.bombWhite); \n                    // animation  = instantEffect.getComponent(cc.Animation); \n                    // animation.play(\"effect_line\"); \n                // } \n                // else if(cmd.action == \"colBomb\"){ \n                    // instantEffect = cc.instantiate(this.bombWhite); \n                    // animation  = instantEffect.getComponent(cc.Animation); \n                    // animation.play(\"effect_col\"); \n                // } \n                // instantEffect.x = CELL_WIDTH * (cmd.pos.x - 0.5); \n                // instantEffect.y = CELL_WIDTH * (cmd.pos.y - 0.5); \n                // instantEffect.parent = this.node; \n                // animation.on(\"finished\",function(){ \n                    // instantEffect.destroy(); \n                // },this); \n            // },this); \n            // this.node.runAction(cc.sequence(delayTime, callFunc)); \n        // },this); \n    }\n\n}\n\n\n/**\n * 注意：已把原脚本注释，由于脚本变动过大，转换的时候可能有遗落，需要自行手动转换\n */\n// import {CELL_WIDTH} from '../Model/ConstValue';\r\n// \r\n// import AudioUtils from \"../Utils/AudioUtils\";\r\n// cc.Class({\r\n//     extends: cc.Component,\r\n// \r\n//     properties: {\r\n//         // foo: {\r\n//         //    default: null,      // The default value will be used only when the component attaching\r\n//         //                           to a node for the first time\r\n//         //    url: cc.Texture2D,  // optional, default is typeof default\r\n//         //    serializable: true, // optional, default is true\r\n//         //    visible: true,      // optional, default is true\r\n//         //    displayName: 'Foo', // optional\r\n//         //    readonly: false,    // optional, default is false\r\n//         // },\r\n//         // ...\r\n//         bombWhite:{\r\n//             default: null,\r\n//             type: cc.Prefab\r\n//         },\r\n//         crushEffect:{\r\n//             default: null,\r\n//             type: cc.Prefab\r\n//         },\r\n//         audioUtils:{\r\n//             type: AudioUtils,\r\n//             default: null\r\n//         }\r\n//     },\r\n// \r\n//     // use this for initialization\r\n//     onLoad: function () {\r\n// \r\n//     },\r\n//     playEffects: function(effectQueue){\r\n//         if(!effectQueue || effectQueue.length <= 0){\r\n//             return ;\r\n//         }\r\n//         let soundMap = {}; //某一时刻，某一种声音是否播放过的标记，防止重复播放\r\n//         effectQueue.forEach(function(cmd){\r\n//             let delayTime = cc.delayTime(cmd.playTime);\r\n//             let callFunc = cc.callFunc(function(){\r\n//                 let instantEffect = null;\r\n//                 let animation = null;\r\n//                 if(cmd.action == \"crush\"){\r\n//                     instantEffect = cc.instantiate(this.crushEffect);\r\n//                     animation  = instantEffect.getComponent(cc.Animation);\r\n//                     animation.play(\"effect\");\r\n//                     !soundMap[\"crush\" + cmd.playTime] && this.audioUtils.playEliminate(cmd.step);\r\n//                     soundMap[\"crush\" + cmd.playTime] = true;\r\n//                 }\r\n//                 else if(cmd.action == \"rowBomb\"){\r\n//                     instantEffect = cc.instantiate(this.bombWhite);\r\n//                     animation  = instantEffect.getComponent(cc.Animation);\r\n//                     animation.play(\"effect_line\");\r\n//                 }\r\n//                 else if(cmd.action == \"colBomb\"){\r\n//                     instantEffect = cc.instantiate(this.bombWhite);\r\n//                     animation  = instantEffect.getComponent(cc.Animation);\r\n//                     animation.play(\"effect_col\");\r\n//                 }\r\n// \r\n//                 instantEffect.x = CELL_WIDTH * (cmd.pos.x - 0.5);\r\n//                 instantEffect.y = CELL_WIDTH * (cmd.pos.y - 0.5);\r\n//                 instantEffect.parent = this.node;\r\n//                 animation.on(\"finished\",function(){\r\n//                     instantEffect.destroy();\r\n//                 },this);\r\n//                \r\n//             },this);\r\n//             this.node.runAction(cc.sequence(delayTime, callFunc));\r\n//         },this);\r\n//     },\r\n// \r\n//     // called every frame, uncomment this function to activate update callback\r\n//     // update: function (dt) {\r\n// \r\n//     // },\r\n// });\n"]}