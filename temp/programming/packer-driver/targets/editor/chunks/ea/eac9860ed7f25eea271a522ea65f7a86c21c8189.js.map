{"version":3,"sources":["file:///D:/dev/%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9/NewProject/assets/Script/Utils/Toast.ts"],"names":["Toast","text","gravity","duration","bg_color","cc","color","canvas","director","getScene","getComponentInChildren","Canvas","width","node","height","bgNode","Node","textNode","textLabel","addComponent","Label","horizontalAlign","HorizontalAlign","CENTER","verticalAlign","VerticalAlign","fontSize","string","length","overflow","Overflow","RESIZE_HEIGHT","lineCount","ctx","Graphics","arc","Math","PI","lineTo","fillColor","fill","addChild","y","x","finished","callFunc","destroy","action","sequence","moveBy","v2","fadeOut","runAction","module","exports"],"mappings":"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","sourcesContent":["//一个简单的tost组件，用法：\r\n// let Toast = reqire('Toast.js')\r\n// Toast(text,{gravity,duration,bg_color})\r\n//text:要显示的字符串\r\n//gravity(可选):位置，String类型，可选值('CENTER','TOP','BOTTOM'),默认为'CENTER'\r\n//duration(可选):时间，Number类型，单位为秒，默认1s\r\n//bg_color(可选):颜色，cc.color类型，默认cc.color(102, 102, 102, 200)\r\nfunction Toast(\r\n  text = \"\",\r\n  {\r\n    gravity = \"CENTER\",\r\n    duration = 1,\r\n    bg_color = cc.color(102, 102, 102, 200)\r\n  } = {}\r\n) {\r\n  // canvas\r\n  let canvas = cc.director.getScene().getComponentInChildren(cc.Canvas);\r\n  let width = canvas.node.width;\r\n  let height = canvas.node.height;\r\n\r\n  let bgNode = new cc.Node();\r\n\r\n  // Lable文本格式设置\r\n  let textNode = new cc.Node();\r\n  let textLabel = textNode.addComponent(cc.Label);\r\n  textLabel.horizontalAlign = cc.Label.HorizontalAlign.CENTER;\r\n  textLabel.verticalAlign = cc.Label.VerticalAlign.CENTER;\r\n  textLabel.fontSize = 30;\r\n  textLabel.string = text;\r\n\r\n  // 当文本宽度过长时，设置为自动换行格式\r\n  if (text.length * textLabel.fontSize > (width * 3) / 5) {\r\n    textNode.width = (width * 3) / 5;\r\n    textLabel.overflow = cc.Label.Overflow.RESIZE_HEIGHT;\r\n  } else {\r\n    textNode.width = text.length * textLabel.fontSize;\r\n  }\r\n  let lineCount =\r\n    ~~((text.length * textLabel.fontSize) / ((width * 3) / 5)) + 1;\r\n  textNode.height = textLabel.fontSize * lineCount;\r\n\r\n  // 背景设置\r\n  let ctx = bgNode.addComponent(cc.Graphics);\r\n  ctx.arc(\r\n    -textNode.width / 2,\r\n    0,\r\n    textNode.height / 2 + 20,\r\n    0.5 * Math.PI,\r\n    1.5 * Math.PI,\r\n    true\r\n  );\r\n  ctx.lineTo(textNode.width / 2, -(textNode.height / 2 + 20));\r\n  ctx.arc(\r\n    textNode.width / 2,\r\n    0,\r\n    textNode.height / 2 + 20,\r\n    1.5 * Math.PI,\r\n    0.5 * Math.PI,\r\n    true\r\n  );\r\n  ctx.lineTo(-textNode.width / 2, textNode.height / 2 + 20);\r\n  ctx.fillColor = bg_color;\r\n  ctx.fill();\r\n\r\n  bgNode.addChild(textNode);\r\n\r\n  // gravity 设置Toast显示的位置\r\n  if (gravity === \"CENTER\") {\r\n    bgNode.y = 0;\r\n    bgNode.x = 0;\r\n  } else if (gravity === \"TOP\") {\r\n    bgNode.y = bgNode.y + (height / 5) * 2;\r\n  } else if (gravity === \"BOTTOM\") {\r\n    bgNode.y = bgNode.y - (height / 5) * 2;\r\n  }\r\n\r\n  canvas.node.addChild(bgNode);\r\n\r\n  let finished = cc.callFunc(function() {\r\n    bgNode.destroy();\r\n  });\r\n  let action = cc.sequence(\r\n    cc.moveBy(duration, cc.v2(0, 0)),\r\n    cc.fadeOut(0.3),\r\n    finished\r\n  );\r\n  bgNode.runAction(action);\r\n}\r\n\r\nmodule.exports = Toast;"]}