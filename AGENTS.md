# AGENTS.md

Guidance for AI coding agents working in this repository.

## Project Overview
- Game built with Cocos Creator 3.8.6 and TypeScript.
- Source code lives under `assets/Script/`.
- Scenes: `assets/Scene/Login.scene` and `assets/Scene/Game.scene`.
- Level flow: `LoginController` preloads Level scene -> `LevelSelectController` -> `GameController`.

## Tooling Status
- This repo does not use npm/yarn scripts for build or lint.
- Builds, previews, and most testing happen inside the Cocos Creator editor.
- Node modules are present for Creator tooling, but no CLI tasks are defined.

## Build / Run / Test Commands

### Open & Run (Primary Workflow)
- Open project in Cocos Creator 3.8.6.
- Use the editor menu: `Project -> Build` for platform builds.
- Use the editor toolbar: `Preview/Run` for local playtesting.

### Command Line
- No documented CLI build or test commands exist in this repo.
- There is no `scripts` section in `package.json`.

### Single Test Guidance
- There is no automated test runner.
- `assets/Script/UnitTest/GameModelTest.ts` is a placeholder component; run tests manually by attaching scripts to a scene and using the editor Preview.
- If you add a test harness, document the exact CLI or editor steps here.

## Cocos Creator / TypeScript Notes
- Creator version: 3.8.6 (match the project version to avoid asset serialization issues).
- TypeScript is strict (`tsconfig.json` enables strict + noImplicitAny).
- Engine APIs are imported from `cc`.

## Copilot / Cursor Rules

### Copilot Instructions (`.copilot-instructions.md`)
- OpenEmoji assets in `openemoji/` are named by Unicode code point (e.g. `1F3C6.png`).
- When copying OpenEmoji assets into `assets/resources/`, rename them to descriptive names.
- Examples: `1F31F.png` -> `star.png`, `1F3C6.png` -> `trophy.png`.
- Cocos 3.x project, TypeScript with strict type checking, use `cc` module imports.

### Cursor Rules
- No `.cursor/rules/` or `.cursorrules` found in this repo.

## Code Style Guidelines

### Imports
- Use ES module imports, keep engine imports from `cc` grouped at the top.
- Prefer named imports from `cc` rather than default imports.
- Use type-only imports when possible (`import type { EffectCommand } ...`).
- Use relative paths for local modules (`../Model/GameModel`).

### Formatting
- Indent with 2 spaces in most model classes (e.g. `GameModel.ts`).
- Some controllers use 4 spaces; follow the local file style when editing.
- Keep lines readable; prefer early returns to reduce nesting.
- Use single quotes for strings (observed across TS files).

### Types
- Enable strict types; avoid `any` unless unavoidable.
- Use union types for nullable values (`AudioSource | null`).
- Prefer explicit return types on public methods.
- Use `type` or `interface` to model data contracts (e.g. `EffectCommand`).

### Naming
- Classes are PascalCase: `GameController`, `LevelSelectController`.
- Methods are camelCase: `initLevel`, `updateHud`.
- Properties are camelCase; booleans use `isX` or `hasX`.
- Constants live in `assets/Script/Model/ConstValue.ts` and are UPPER_SNAKE_CASE.

### Error Handling & Logging
- Prefer guard clauses for null checks (`if (!this.grid) return`).
- Use `console.error` for fatal failures; `console.warn` for soft failures.
- If async work can fail, wrap in `try/catch` and log the error.

### Component Patterns
- Use `@ccclass` and `@property` decorators for Cocos components.
- Add components via `node.addComponent` when dynamic creation is required.
- For UI initialization, check `Node` validity and scene availability before use.
- Use `scheduleOnce`/`schedule` for animation timing; avoid `setTimeout`.

### Scene & Resource Loading
- Use `director.loadScene` or `director.preloadScene`.
- Use `resources.load` with the specific asset type.
- When loading sprite frames, include `/spriteFrame` in the path.
- Keep resource paths under `assets/resources/` for runtime loading.

### Data & Game Logic
- Game rules are in model classes under `assets/Script/Model/`.
- Views (grid/cell UI) should rely on model outputs; avoid game logic in views.
- Controllers own scene lifecycle, audio, HUD, and high-level state.

### Miscellaneous
- Avoid modifying `temp/` and `library/` outputs; they are generated by Creator.
- Do not remove `.meta` files; they are required for asset tracking.
- Use `sys.localStorage` for small persistent settings (e.g. volume).

## Suggested Workflow for Agents
- Open the repo in Cocos Creator 3.8.6 to run and verify UI changes.
- Make incremental edits in `assets/Script/` and test via Preview.
- Keep engine API usage consistent with existing code patterns.
